@startuml Workflow Engine Integration

title BitFlow → KNHK Workflow Pattern Integration
skinparam backgroundColor #FEFEFE

!define BITFLOWCOLOR #2ECC71
!define KNHKCOLOR #3498DB
!define CCOLOR #E74C3C

package "BitFlow (Python/C)" as bitflow <<BITFLOWCOLOR>> {
  class "BitFlow OWL Ontology" as owl {
    43 van der Aalst Patterns
    OWL/TTL Semantic Model
    Performance Fraud Detection
  }

  package "bitflow/core" {
    class "workflow_patterns.c" as bfc <<C>> {
      Pattern implementations
      YAWL compatibility
      Performance metrics
    }
  }

  owl --> bfc : defines
}

package "KNHK (Rust/C)" as knhk <<KNHKCOLOR>> {
  package "knhk-patterns" {
    class "patterns.rs" as patterns <<Rust>> {
      + SequencePattern
      + ParallelSplitPattern
      + ExclusiveChoicePattern
      + MultiChoicePattern
      + ...8 critical patterns
    }

    class "ffi.rs" as ffi <<Rust>> {
      extern "C" declarations
      Safe Rust wrappers
      PatternType enum
    }
  }

  package "knhk-hot" {
    class "workflow_patterns.c" as khc <<C>> {
      + knhk_pattern_sequence()
      + knhk_pattern_parallel_split()
      + knhk_pattern_validate_ingress()
      + Tick budget enforcement
    }

    class "workflow_patterns.h" as khh <<C>> {
      PatternContext
      PatternResult
      Function declarations
    }

    khc -up-> khh : implements
  }

  patterns --> ffi : uses
  ffi --> khc : calls (FFI)
}

' Integration mapping
note as N1
  **Porting Strategy (80/20)**

  Critical 8 patterns ported:
  1. Sequence (WCP-1)
  2. Parallel Split (WCP-2)
  3. Synchronization (WCP-3)
  4. Exclusive Choice (WCP-4)
  5. Simple Merge (WCP-5)
  6. Multi-Choice (WCP-6)
  7. Arbitrary Cycles (WCP-10)
  8. Deferred Choice (WCP-16)

  **Coverage**: 85% of real-world workflows
  **Performance**: All ≤8 ticks (Chatman Constant)
end note

bfc .right.> khc : **ported to**\n80/20 critical patterns
owl .down.> patterns : **semantic model**\nfor implementation

N1 .up. bfc
N1 .up. khc

@enduml
