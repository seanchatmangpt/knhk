import { createDarkMatterCore } from './src/knowledge-engine/knowledge-substrate-core.mjs';
import { toTurtle, toJsonLd, toNQuads } from './src/knowledge-engine/serialize.mjs';

async function main() {
    const system = await createDarkMatterCore({
        enableKnowledgeHookManager: true,
        enableLockchainWriter: false
    });

    const format = '{{ format }}';
    let result;

    try {
        // Get the store from the system
        const store = system.store || system.getStore();

        if (format === 'turtle') {
            result = await toTurtle(store);
        } else if (format === 'jsonld') {
            result = await toJsonLd(store);
        } else if (format === 'nquads') {
            result = await toNQuads(store);
        } else {
            throw new Error('Unknown format: ' + format);
        }

        console.log(result);
    } catch (err) {
        console.error('ERROR:', err.message);
        process.exit(1);
    }
}

main().catch(err => {
    console.error('ERROR:', err.message);
    process.exit(1);
});

