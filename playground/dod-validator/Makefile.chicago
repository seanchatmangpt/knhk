# Chicago TDD Tests Makefile

TEST_DIR = .
C_TEST = tests/chicago_autonomous_dod_validator.c
C_TEST_BIN = tests/chicago_autonomous_dod_validator
KNHK_ROOT = ../..
C_INCLUDE = $(KNHK_ROOT)/c/include
C_LIB = $(KNHK_ROOT)/c/libknhk.a

.PHONY: test-chicago-autonomous test-chicago-autonomous-c test-chicago-autonomous-rust

test-chicago-autonomous: test-chicago-autonomous-c test-chicago-autonomous-rust

test-chicago-autonomous-c: $(C_TEST_BIN)
	@echo "Running C Chicago TDD tests..."
	./$(C_TEST_BIN)

test-chicago-autonomous-rust:
	@echo "Running Rust Chicago TDD tests..."
	cd rust/dod-validator-autonomous && cargo test --lib

$(C_TEST_BIN): $(C_TEST) $(C_LIB)
	@echo "Building C Chicago TDD test..."
	$(CC) -std=c11 -O2 -I$(C_INCLUDE) -I$(KNHK_ROOT)/c/src -L$(KNHK_ROOT)/c $(C_TEST) -o $(C_TEST_BIN) -lknhk

clean:
	rm -f $(C_TEST_BIN)

help:
	@echo "Chicago TDD Tests Makefile"
	@echo ""
	@echo "Targets:"
	@echo "  make test-chicago-autonomous     - Run all Chicago TDD tests"
	@echo "  make test-chicago-autonomous-c  - Run C tests only"
	@echo "  make test-chicago-autonomous-rust - Run Rust tests only"
	@echo "  make clean                      - Clean test binaries"

